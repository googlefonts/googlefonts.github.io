# Lang Metadata System

<a href="./index"><button class="button button-i">&larr; GF Guide Index</button></a>

The foundation for the *lang metadata system* is defined in the [`googlefonts/lang`](https://github.com/googlefonts/lang) repo

## Constructs

- [**Language**](https://github.com/googlefonts/lang/tree/main/Lib/gflanguages/data/languages)
  - Application of some writing system (e.g. English)
- [**Region**](https://github.com/googlefonts/lang/tree/main/Lib/gflanguages/data/regions)
  - Geo area (e.g. United States)
  - Grouped further into region groups (e.g. Asia)
- [**Script**](https://github.com/googlefonts/lang/tree/main/Lib/gflanguages/data/scripts)
  - Writing system (e.g. Latin)

## Other definitions

**Coverage** – the set of codepoints covered by a given family; in this context, that set is further reduced to the codepoints that would be available at serving time via the Google Fonts API.

## `METADATA.pb`

In font metadata files, we have several controls that influence how lang metadata manifests further downstream.

- **Primary script** (`primary_script`)
  - Sets the script of the default *sample text* for when no other lang filters are specified
- **Primary language** (`primary_language`)
  - Sets the language of the default *sample text* for when no other lang filters are specified
- **Supported languages** (`languages`)
  - Autogenerated; can manually override by specifying in `METADATA.pb`
  - Language support is determined by whether coverage includes the entire base character set (i.e. `exemplar_chars.base`) of a language
  - Has the side effect that languages without `exemplar_chars` in their metadata will never be included in an autogenerated language set
  - Do NOT manually specify except on Noto families for the purposes of including an exhaustive language set
- **Sample glyphs** (`sample_glyphs`)
  - Autogenerated; can manually override by specifying in `METADATA.pb`
  - Filtered from [`unicode_sections`](<url>) using intersection with coverage
  - Avoid manually specifying except for families without meaningful codepoint support (e.g. Noto Emoji)

## Catalog ([fonts.google.com](https://fonts.google.com))

The primary consumer of *lang* metadata is Catalog. There are a couple areas where *lang* metadata influences how fonts are presented.

- Sample text
  - Used in both grid tiles and specimens
  - Possible sample texts are those of any support language of the font family
  - Assuming autogenerated language support metadata, may still display tofu if:
    - Coverage for font X includes base character set for language Y
    - Coverage for font X does not include all of the characters required to render the sample text of language Y
- Specimen – Glyphs
  - Shows the sample glyphs
  - We believe we have systematically eliminated the possibility of displaying tofu here
